<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>SmartSeat — Profile</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="style.css">
</head>

<body>
<header class="navbar">
  <div class="brand">
    <div class="logo">SS</div>
    <div style="font-weight:600">SmartSeat</div>
  </div>
  <div class="nav-right">
    <a href="home.html">Home</a>
    <a href="about.html">About</a>
  </div>
</header>

<div class="container">
  <div class="grid">
    <main>
      <div class="card">
        <h2>My Profile</h2>

        <div style="display:flex;gap:12px;align-items:center">
          <div class="img-placeholder" style="width:120px;height:120px;border-radius:12px">Avatar</div>
          <div>
            <h3 id="userName">Student Name</h3>
            <p class="small" id="userEmail">name@university.edu</p>
            <p class="small" id="userAccess">Accessibility needs: No</p>
            <div style="margin-top:8px">
              <button onclick="window.location.href='edit-profile.html'">Edit Profile</button>
            </div>
          </div>
        </div>

        <h3 style="margin-top:18px">Recent Reservations</h3>
        <div id="history-list" style="margin-top:10px"></div>
      </div>

      <div class="card" style="margin-top:20px">
        <h3>Accessibility Settings</h3>
        <label><input type="checkbox" id="wheelchair"> Require wheelchair access</label><br>
        <label><input type="checkbox" id="wideSeat"> Prefer wide seats</label><br>
        <button style="margin-top:10px" onclick="saveAccessibility()">Save Accessibility</button>
      </div>

      <div class="card" style="margin-top:20px">
        <h3>System Settings</h3>
        <label><input type="checkbox" id="notify"> Receive booking notifications</label><br>
        <label>Language:
          <select id="lang"><option>English</option><option>中文</option></select>
        </label><br>
        <button style="margin-top:10px" onclick="saveSystemSettings()">Save Settings</button>
      </div>

      <div style="margin-top:24px">
        <button class="red" onclick="logout()">Logout</button>
      </div>
    </main>

    <aside class="side-panel">
      <div class="card">
        <h3>Preferences</h3>
        <div class="small">Default seating: Near front</div>
        <div style="margin-top:12px">
          <button class="gray" onclick="alert('Manage team members placeholder')">Manage Team</button>
        </div>
      </div>

      <div class="card" style="margin-top:12px">
        <h3>Help</h3>
        <div class="small">For issues contact support@smartseat.local</div>
      </div>
    </aside>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", ()=>{
  const history = JSON.parse(localStorage.getItem("reservations") || "[]");
  const list = document.getElementById("history-list");

  if(history.length === 0){
    list.innerHTML = "<p class='small'>No reservations yet.</p>";
  } else {
    history.forEach((r,i)=>{
      const div=document.createElement("div");
      div.className="card small";
      div.style.marginTop="8px";
      div.innerHTML = `
        <b>${r.venue}</b> — Seat ${r.seat}<br>
        <span>${r.time}</span><br>
        <button class='red' style='margin-top:5px' onclick='cancelBooking(${i})'>Cancel</button>
      `;
      list.appendChild(div);
    });
  }
});

function cancelBooking(i){
  let h=JSON.parse(localStorage.getItem("reservations")||"[]");
  h.splice(i,1);
  localStorage.setItem("reservations",JSON.stringify(h));
  location.reload();
}

function logout(){
  localStorage.clear();
  alert("You have logged out.");
  window.location.href="index.html";
}

function saveAccessibility(){
  const prefs={
    wheelchair:document.getElementById('wheelchair').checked,
    wideSeat:document.getElementById('wideSeat').checked
  };
  localStorage.setItem("accessPrefs",JSON.stringify(prefs));
  alert("Accessibility preferences saved!");
}

function saveSystemSettings(){
  const s={
    notify:document.getElementById('notify').checked,
    lang:document.getElementById('lang').value
  };
  localStorage.setItem("systemSettings",JSON.stringify(s));
  alert("System settings saved!");
}
</script>

</body>
</html>
